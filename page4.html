<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>실험 v2 · Page 4 (자극물 안내)</title>
<style>
  :root{--bg:#ffffff;--line:#e5e7eb;--pri:#2563eb;--muted:#6b7280}
  *{box-sizing:border-box}
  html,body{height:100%}
  body{margin:0;background:var(--bg);font-family:system-ui,-apple-system,Segoe UI,Roboto,Apple SD Gothic Neo,Noto Sans KR,Arial,sans-serif;color:#111827;display:flex;align-items:center;justify-content:center}
  .popup{background:#fff;border:1px solid var(--line);border-radius:14px;box-shadow:0 8px 30px rgba(0,0,0,.08);padding:24px;max-width:420px;width:100%;text-align:center}
  h1{font-size:18px;margin:0 0 12px}
  p{margin:8px 0;color:#374151}
  .muted{color:var(--muted);font-size:13px}
  .btn{border:none;border-radius:10px;padding:12px 16px;background:var(--pri);color:#fff;font-weight:700;cursor:pointer;margin-top:14px}
</style>
</head>
<body>
  <main class="popup" aria-labelledby="ttl">
    <h1 id="ttl">실험 안내</h1>
    <p>다음은 한 소셜 미디어에 게시된 글입니다.</p>
    <p class="muted">글은 <strong>45초</strong>간 제시됩니다.</p>
    <button id="go" class="btn">읽기</button>
  </main>

<script>
/***** ▼ 설정 ▼ *****/
const LOG_ENDPOINT = "https://script.google.com/macros/s/AKfycbz4L7LVxclV8VCzzNR7zjVh1gzD_wZPfs2HFXE_JVyowsYgzECbKLPcvyTCYR9sg_rH/exec"; // Apps Script Web App URL
const NEXT_PAGE_URL = "page5.html"; // 다음 페이지(자극물 실제 제시)
/***** ▲ 설정 끝 ▲ *****/

(function(){
  const startMs = performance.now();
  const pid = localStorage.getItem('exp_pid') || new URLSearchParams(location.search).get('pid') || null;
  const go = document.getElementById('go');

  async function log(type, detail){
    const payload = { type, ts:new Date().toISOString(), ms:Math.round(performance.now()-startMs), pid, url:location.href, ua:navigator.userAgent, detail };
    try{ await fetch(LOG_ENDPOINT,{method:'POST',mode:'no-cors',headers:{'Content-Type':'application/json'},body:JSON.stringify(payload)});}catch(e){ try{navigator.sendBeacon && navigator.sendBeacon(LOG_ENDPOINT,new Blob([JSON.stringify(payload)],{type:'application/json'}));}catch(_){}}
  }

  log('page_load',{page:4});

  go.addEventListener('click', async ()=>{
    await log('stimulus_intro_next',{});
    location.href = NEXT_PAGE_URL + (pid?`?pid=${encodeURIComponent(pid)}`:'');
  });
})();
</script>
</body>
</html>
